<!-- <style>
	.outerDiv{
		background-color: white;
		/*width: 95%;*/
		margin: 0 auto;
		overflow: hidden;
		padding: 15px 50px 0 10px
	}
	.caption span{
		position: absolute;
		left:140px;
	}
	.row{
		margin-top: 15px;
	}
	#myModal{
		background-color: rgba(159,159,159,0.3);
	}
	.modal-dialog{
		position: fixed;
		right: 0;
		top:-25px;
		width: 415px;
		/*height: 1000px;*/
	}
	.close{
		position: absolute;
		font-size: 18px;
		left: 15px;
		top: 25px;
	}
	.form-group{
		padding:0 30px 0 30px;
	}
	.form-group input{
		margin-top: 10px;
	}
	.modal-content{
		color: #999999;
	}
	.modal-footer{
		padding-bottom: 200px;
	}
</style> -->

<!-- <div id="user">
	<div class="modal" id="myModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header text-center">
						<button class="close"><返回</button>
						<div class="modal-title" style="font-size: 22px;">添加用户</div>
					</div>
					<div class="modal-body">
						<form class="form-horizontal" action="">
							<div class="form-group">
								<label for="" class="control-label" >用户名</label>
								
								<input type="text" class="form-control" name="gradeName">
							</div>
							<div class="form-group">
								<label for="" class="control-label">密码</label>
								
								<input type="text" class="form-control">
							</div>
							<div class="form-group">
								<label for="" class="control-label" >重复密码</label>
								
								<input type="text" class="form-control">
							</div>
							<div class="form-group">
								<label for="" class="control-label">真实姓名</label>
								
								<input type="text" class="form-control">
							</div>
							<div class="form-group">
								<label for="" class="control-label">手机号</label>
								<input type="text" class="form-control">
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
	<!-- <div class="outerDiv">
		<button class="btn btn-success addUser" style="width: 70px;">新增</button>
		<div class="row">
		  <div class="col-sm-6 col-md-4">
		    <div class="thumbnail">
		      <img src="images/头像1.jpg" class="img-circle" alt="..." width="50%">
		      <div class="caption">
			      <p>用户名</p>
			      <p>真实姓名</p>
			      <p>手机号</p>
			      <p>email</p>
			      <p>状态</p>
		      </div>
		    </div>
		  </div>
		</div>
	</div>
</div> -->

<!-- <script>
	$(function(){
		$('.addUser').click(function(){
				$('#myModal').fadeIn(300)
			})
			// X
			$('.close').click(closeModal)
			$('button:contains(返回)').click(closeModal);
			function closeModal(){
				$('#myModal').fadeOut(300)
			}

		// $.getJSON('http://120.78.164.247:8099/manager/user/findAllUser',function(item){
		// 	var html='';
		// 	$.each(item.data,function(index){
		// 		html +='<div class="col-sm-4 col-md-3">';
		// 		html +='<div class="thumbnail">';
		// 		html +='<img src="images/头像1.jpg" class="img-circle" alt="..." width="50%"><div class="caption">';
		// 		html +='<p class="id">用户名:<span>'+item.data[index].id+'</span></p>';
		// 		html +='<p class="name">真实姓名:<span>'+item.data[index].username+'</span></p>';
		// 		html +='<p>email:<span>'+item.data[index].email+'</span></p>';
		// 		html +='<p>nickname:<span>'+item.data[index].nickname+'</span></p>';
		// 		html +='<div class="switch"><input type="checkbox" checked /></div>';
		// 		html +='</div></div></div>';
		// 		$('.row').html(html);
		// 	})
		// })
	})
</script> -->


<div id="user">
		<button class="btn btn-success btn-sm addBtn">新 增</button>
		<div class="row margintop">
		  <!-- <div class="col-sm-4">
		    <div class="thumbnail">
		      <img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1514093920321&di=913e88c23f382933ef430024afd9128a&imgtype=0&src=http%3A%2F%2Fp.3761.com%2Fpic%2F9771429316733.jpg" width="55%"  alt="图片找不到了" class="img-circle">
		      <div class="caption">
		        <div class="row">
		        	<div class="col-sm-4 col-sm-offset-1">用户名</div>
			        <div class="col-sm-7">vicky</div>
		        </div>
		        <div class="row">
		        	<div class="col-sm-4 col-sm-offset-1">真实姓名</div>
			        <div class="col-sm-7">乔美丽</div>
		        </div>
		        <div class="row">
		        	<div class="col-sm-4 col-sm-offset-1">注册时间</div>
			        <div class="col-sm-7">2018-09-09</div>
		        </div>
		        <div class="row">
		        	<div class="col-sm-4 col-sm-offset-1">email</div>
			        <div class="col-sm-7">949160283@qq.com</div>
		        </div>
		        <div class="row">
		        	<div class="col-sm-4 col-sm-offset-1">状态</div>
			        <div class="switch col-sm-7">
			        	<input type="hidden" value="1001">
		        		<input type="checkbox" checked/>
		       		</div>
		        </div>
		        
		      </div>
		    </div>
		  </div>
		</div>-->
		<div class="modal" id="userModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-head text-center">
						<div class="backDiv">
							<i class="iconfont icon-zuo"></i>
							<span>返回</span>
						</div>
						<div class="modal-title">
						添加用户
						</div>
					</div>
					<div class="modal-body">
						<!-- 表单 -->
						<form class="form">
							<div class="form-group">
								<label for="">用户名</label>
								<input type="text" name="username" class="form-control">
							</div>
							<div class="form-group">
								<label for="">密码</label>
								<input type="password" name="password" class="form-control">
							</div>
							<div class="form-group">
								<label for="">确认密码</label>
								<input type="password" name="password1" class="form-control">
							</div>
							<div class="form-group">
								<label for="">真实姓名</label>
								<input type="text" name="nickname" class="form-control">
							</div>
							<div class="form-group">
								<label for="">邮箱</label>
								<input type="email" name="email" class="form-control">
							</div>
							<div class="form-group hide">
								<button type="reset">重置</button>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<span class="messageSpan"></span>
						<button class="btn btn-success btn-sm saveBtn">确 认</button>
					</div>
				</div>
			</div>
		</div>
		<!-- 警告框 -->
		<div class="alertDiv">
			<div class="alert alert-success">
				<strong>提示：</strong>
				<span>操作成功</span>
			</div>
		</div>


		<!-- <div class="modal" id="myModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header text-center">
						<button class="close"><返回</button>
						<div class="modal-title" style="font-size: 22px;">添加用户</div>
					</div>
					<div class="modal-body">
						<form class="form-horizontal" action="">
							<div class="form-group">
								<label for="" class="control-label" >用户名</label>
								
								<input type="text" class="form-control" name="gradeName">
							</div>
							<div class="form-group">
								<label for="" class="control-label">密码</label>
								
								<input type="password" class="form-control" name="password">
							</div>
							<div class="form-group">
								<label for="" class="control-label" >重复密码</label>
								
								<input type="password" class="form-control" name="password">
							</div>
							<div class="form-group">
								<label for="" class="control-label">真实姓名</label>
								
								<input type="text" class="form-control">
							</div>
							<div class="form-group">
								<label for="" class="control-label">email</label>
								<input type="text" class="form-control">
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div> -->



</div>


<script>
	$(function(){
		// 设置.modal-content的高度
		$('.modal-content').height($(window).height());
		// 绑定新增事件
		$('.addUser').click(function(){
			// 清空表单数据，显示模态框
			$('button[type=reset]').trigger('click');
			$('.messageSpan').html('');
			$('#userModal').show();
		});
		$('.backDiv').click(function(){
			$('#userModal').hide();
		});
		// 确认按钮的事件
		$('.saveBtn').click(function(){
			// 获取input内容，进行简单的表单验证，提示或者提交
			var username = $('input[name=username]').val();
			var password = $('input[name=password]').val();
			var password1 = $('input[name=password1]').val();
			var nickname = $('input[name=nickname]').val();
			var email = $('input[name=email]').val();
			var message = '';
			if(username&&password&&password1&&nickname&&email){
				if(password==password1){
					// 提交
					var obj = {
						username:username,
						password:password,
						nickname:nickname,
						email:email,
					};
					$.post(baseURL+'/manager/user/saveOrUpdateUser',obj,function(res){
						console.log('保存成功');
						// 刷新页面，关闭模态框，提示用户保存成功
						loadData();
						$('#userModal').hide();
						
						$('.alertDiv').addClass('animated slideInRight');
						$('.alertDiv').show();
						setTimeout(function(){
							$('.alertDiv').fadeOut(3000);
						},2000);
					});
				}else{
					message = "密码不一致";
				}
			}else{
				message = "请输入完整的信息";
			}
			$('.messageSpan').html(message);
		});

		// // 表单验证
		// 	// 给对应的form-group追加类has-success/has-error
		// 	// 大于6个字符才算通过样式验证
		// 	// 当键盘抬起的时候判断input中的value值是否大于6
		// 	$(':input').keyup(function(){
		// 		// 区分不同的input 
		// 		if ($(this).attr('name')=='gradeName') {
		// 			if ($(this).val().length>6) {
		// 				// 给对应的form-group添加类has-success
		// 				$(this).closest('.form-group').addClass('has-success')
		// 				$(this).closest('.form-group').removeClass('has-error')
		// 			}else{
		// 				$(this).closest('.form-group').addClass('has-error')
		// 				$(this).closest('.form-group').removeClass('has-success')
		// 			}
		// 		}
		// 		if ($(this).attr('name')=='password') {
		// 			if ($(this).val().length>8) {
		// 				// 给对应的form-group添加类has-success
		// 				$(this).closest('.form-group').addClass('has-success')
		// 				$(this).closest('.form-group').removeClass('has-error')
		// 			}else{
		// 				$(this).closest('.form-group').addClass('has-error')
		// 				$(this).closest('.form-group').removeClass('has-success')
		// 			}
		// 		}
		// 	}) 
		// 	$('button:contains(确认)').click(function(){
		// 				if ($('.has-error').length==0) {
		// 					console.log('保存成功')
		// 					console.log($('input').val())
		// 					$('#myModal').slideUp(1000)
		// 				}else{
		// 					$('.alertDiv').slideDown(300);
		// 					setTimeout(function(){
		// 						$('.alertDiv').slideUp(3000)
		// 					},1000)
		// 				}
		// 			})

		// // 隐藏显示模态框
		// $('.addUser').click(function(){
		// 		$('#myModal').fadeIn(300)
		// 	})
		// 	// X
		// 	$('.close').click(closeModal)
		// 	$('button:contains(返回)').click(closeModal);
		// 	function closeModal(){
		// 		$('#myModal').fadeOut(300)
		// 	}

		// 复选按钮的初始化，设置值
		// $('#user input[type=checkbox]').bootstrapSwitch('state',false);
		$("#user").on({
			'switchChange.bootstrapSwitch':function (event,state) {
		      // alert(state);
		      // 点击修改之后，向后台传递参数
		      // this----input checkbox元素
		      // 查找id
		      var id = $(this).closest('.switch').prev('input').val();
		      // 封装给后台的数据，根据后台的属性名来写对象的属性名。属性值是前端这边来获取的。
		      var obj = {
		      	id:id,
		      	status:state
		      };
		      $.post(baseURL+'/manager/user/changeStatus',obj,function(res){
		      	console.log('执行成功！',res);
		      })
		  }
		},'[type=checkbox]');
		loadData();
		// 获取数据
		function loadData(){
			// 清空数据
			$('.margintop').empty();
			console.log(baseURL,'-----');
			$.get(baseURL+'/manager/user/findAllUser',function(res){
				console.log(res.data);
				res.data.forEach(function(item,index){
					var $thm=$(`<div class="col-sm-4">
								    <div class="thumbnail">
								      <img src="`+(item.userface?item.userface:'images/头像1.jpg')+`" width="55%"  alt="图片找不到了" class="img-circle">
								      <div class="caption">
								        <div class="row">
								        	<div class="col-sm-4 col-sm-offset-1">用户名</div>
									        <div class="col-sm-7">`+(item.username?item.username:'-')+`</div>
								        </div>
								        <div class="row">
								        	<div class="col-sm-4 col-sm-offset-1">真实姓名</div>
									        <div class="col-sm-7">`+(item.nickname?item.nickname:'-')+`</div>
								        </div>
								        <div class="row">
								        	<div class="col-sm-4 col-sm-offset-1">注册时间</div>
									        <div class="col-sm-7">`+(item.regTime?item.regTime:'-')+`</div>
								        </div>
								        <div class="row">
								        	<div class="col-sm-4 col-sm-offset-1">email</div>
									        <div class="col-sm-7">`+(item.email?item.email:'-')+`</div>
								        </div>
								        <div class="row">
								        	<div class="col-sm-4 col-sm-offset-1">状态</div>
									        	<input type="hidden" value="`+item.id+`">
									        <div class="switch col-sm-7">
								        		<input type="checkbox" checked/>
								       		</div>
								        </div>
								      </div>
								    </div>
								  </div>`);
						// 追加节点
						$('.margintop').append($thm);
						$('#user input[type=checkbox]:last').bootstrapSwitch('state',item.enabled);
						// 在这里控制状态
						});
					})
				}
		})
</script>


<style>
	.margintop{
		margin-top: 10px;
	}
	#user{
		margin: 0 auto;
		width: 98%;
	}
	.thumbnail{
		box-shadow: 3px 3px 3px #cccccc;
		font-size: 20px;
		line-height: 40px;
	}
	#myModal,#userModal{
		background-color: rgba(159,159,159,0.3);
	}
	.modal-dialog{
		/*position: fixed;*/
		/*right: 0;*/
		/*top:-25px;*/
		width: 415px;
		margin-top: 0;
		margin-right: 0;
	}
	
	.form-group{
		padding:0 30px 0 30px;
	}
	.form-group input{
		margin-top: 10px;
	}
	.modal-content{
		color: #999999;
	}
	.backDiv{
		float: left;
		cursor: pointer;
	}
	.messageSpan{
		color: red;
	}
	.alertDiv{
		width: 300px;
		position: absolute;
		top: 10px;
		right: 10px;
		display: none;
	}
</style>
